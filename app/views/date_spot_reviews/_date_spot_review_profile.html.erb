<div class="m-5 p-5 bg-white">
  <div class="flex">
    <div class="w-2/3">

        <div class="m-5">
          <%= date_spot_review.user.name %>
        </div>

        <div class="m-5 flex" id = "rate-#{<%= date_spot_review.id%>}">
          <img src ="<%= asset_url('star-off.png') %>" id ="star-1">
          <img src ="<%= asset_url('star-off.png') %>" id ="star-2">
          <img src ="<%= asset_url('star-off.png') %>" id ="star-3">
          <img src ="<%= asset_url('star-off.png') %>" id ="star-4">
          <img src ="<%= asset_url('star-off.png') %>" id ="star-5">
          <label class="mx-4" for="date_spot_review_rate">評価</label>
          <div id ="rateNumber-#{<%= date_spot_review.id%>}">
            <%= date_spot_review.rate %>
          </div>
        </div>

        <div class="m-5">
          <%= date_spot_review.content%>
        </div>
    </div>
    <div class="w-1/3 p-5">
      <%= link_to user_path(date_spot_review.user) do %>
        <%= render 'layouts/image', {target_image: target_image, width: 250, height: 250} %>
      <% end %>
      <%  if current_user && date_spot_review.user == current_user %>
        <div class="text-center m-5">
          <%= link_to "レビューを編集する", edit_date_spot_review_path(date_spot_review), class:"btn btn-salmon" %>
        </div>
        <div class="text-center m-5">
          <%= link_to "削除する", date_spot_review_path(date_spot_review), method: :delete, data: { confirm: "本当に削除しますか？" }, class: "btn btn-red" %>
        </div>
      <% end %>
    </div>
  </div>
</div>

<script>

  // 評価の値に応じて、星の画像を変化させる。
  (function(){
    let images = document.getElementById("rate-#{<%= date_spot_review.id%>}").childNodes;
    let starNumber = Number(document.getElementById("rateNumber-#{<%= date_spot_review.id%>}").innerText);
    let changeCount = (starNumber * 2) - 1;
    for (let i= 1; i <= changeCount; i += 2){
      images[i].setAttribute("src", "<%= asset_url('star-on.png') %>");
    };
  }());

</script>